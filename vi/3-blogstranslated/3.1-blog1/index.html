<!doctype html><html lang=vi class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=../../../images/favicon.png type=image/png><title>Blog 1 :: Báo cáo thực tập</title>
<link href=../../../css/nucleus.css?1765294078 rel=stylesheet><link href=../../../css/fontawesome-all.min.css?1765294078 rel=stylesheet><link href=../../../css/hybrid.css?1765294078 rel=stylesheet><link href=../../../css/featherlight.min.css?1765294078 rel=stylesheet><link href=../../../css/perfect-scrollbar.min.css?1765294078 rel=stylesheet><link href=../../../css/auto-complete.css?1765294078 rel=stylesheet><link href=../../../css/atom-one-dark-reasonable.css?1765294078 rel=stylesheet><link href=../../../css/theme.css?1765294078 rel=stylesheet><link href=../../../css/hugo-theme.css?1765294078 rel=stylesheet><link href=../../../css/theme-workshop.css?1765294078 rel=stylesheet><script src=../../../js/jquery-3.3.1.min.js?1765294078></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../../vi/3-blogstranslated/3.1-blog1/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../../js/lunr.min.js?1765294078></script><script type=text/javascript src=../../../js/auto-complete.js?1765294078></script><script type=text/javascript>var baseurl="https://thanhtu18.github.io/workshop-template//vi"</script><script type=text/javascript src=../../../js/search.js?1765294078></script></div><div class=highlightable><ul class=topics><li data-nav-id=/vi/1-worklog/ title="Nhật ký công việc" class=dd-item><a href=../../../vi/1-worklog/><b>1. </b>Nhật ký công việc
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/1-worklog/1.1-week1/ title="Worklog Tuần 1" class=dd-item><a href=../../../vi/1-worklog/1.1-week1/><b>1.1. </b>Worklog Tuần 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.2-week2/ title="Worklog Tuần 2" class=dd-item><a href=../../../vi/1-worklog/1.2-week2/><b>1.2. </b>Worklog Tuần 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.3-week3/ title="Nhật ký Tuần 3" class=dd-item><a href=../../../vi/1-worklog/1.3-week3/><b>1.3. </b>Nhật ký Tuần 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.4-week4/ title="Nhật ký Tuần 4" class=dd-item><a href=../../../vi/1-worklog/1.4-week4/><b>1.4. </b>Nhật ký Tuần 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.5-week5/ title="Nhật ký Tuần 5" class=dd-item><a href=../../../vi/1-worklog/1.5-week5/><b>1.5. </b>Nhật ký Tuần 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.6-week6/ title="Nhật ký tuần 6" class=dd-item><a href=../../../vi/1-worklog/1.6-week6/><b>1.6. </b>Nhật ký tuần 6
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.7-week7/ title="Nhật ký tuần 7" class=dd-item><a href=../../../vi/1-worklog/1.7-week7/><b>1.7. </b>Nhật ký tuần 7
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.8-week8/ title="Nhật ký tuần 8" class=dd-item><a href=../../../vi/1-worklog/1.8-week8/><b>1.8. </b>Nhật ký tuần 8
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.9-week9/ title="Nhật ký tuần 9" class=dd-item><a href=../../../vi/1-worklog/1.9-week9/><b>1.9. </b>Nhật ký tuần 9
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.10-week10/ title="Nhật ký tuần 10" class=dd-item><a href=../../../vi/1-worklog/1.10-week10/><b>1.10. </b>Nhật ký tuần 10
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.11-week11/ title="Nhật ký tuần 11" class=dd-item><a href=../../../vi/1-worklog/1.11-week11/><b>1.11. </b>Nhật ký tuần 11
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.12-week12/ title="Nhật ký tuần 12" class=dd-item><a href=../../../vi/1-worklog/1.12-week12/><b>1.12. </b>Nhật ký tuần 12
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/2-proposal/ title="Bản đề xuất" class=dd-item><a href=../../../vi/2-proposal/><b>2. </b>Bản đề xuất
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/ title="Các events đã tham gia" class=dd-item><a href=../../../vi/4-eventparticipated/><b>4. </b>Các events đã tham gia
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/4-eventparticipated/4.1-event1/ title="Sự kiện 1" class=dd-item><a href=../../../vi/4-eventparticipated/4.1-event1/><b>4.1. </b>Sự kiện 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.2-event2/ title="Sự kiện 2" class=dd-item><a href=../../../vi/4-eventparticipated/4.2-event2/><b>4.2. </b>Sự kiện 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.3-event3/ title="Sự kiện 3" class=dd-item><a href=../../../vi/4-eventparticipated/4.3-event3/><b>4.3 </b>Sự kiện 3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/ title=Workshop class=dd-item><a href=../../../vi/5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.1-workshop-overview/ title="Giới thiệu" class=dd-item><a href=../../../vi/5-workshop/5.1-workshop-overview/><b>5.1. </b>Giới thiệu
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.2-prerequiste/ title="Các bước chuẩn bị" class=dd-item><a href=../../../vi/5-workshop/5.2-prerequiste/><b>5.2. </b>Các bước chuẩn bị
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.3-lambda/ title=Lambda class=dd-item><a href=../../../vi/5-workshop/5.3-lambda/><b>5.3 </b>Lambda
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.4-apigateway/ title="API Gateway" class=dd-item><a href=../../../vi/5-workshop/5.4-apigateway/><b>5.4 </b>API Gateway
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.6-s3/ title="Khởi tạo S3" class=dd-item><a href=../../../vi/5-workshop/5.6-s3/><b>5.6. </b>Khởi tạo S3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.7-cloudfront/ title="Khởi tạo CloudFront" class=dd-item><a href=../../../vi/5-workshop/5.7-cloudfront/><b>5.7. </b>Khởi tạo CloudFront
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.8-cognito/ title="Thiết lập AWS Cognito Authentication" class=dd-item><a href=../../../vi/5-workshop/5.8-cognito/><b>5.8. </b>Thiết lập AWS Cognito Authentication
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.8-cognito/5.8.1-create-user-pool/ title="Tạo Cognito User Pool" class=dd-item><a href=../../../vi/5-workshop/5.8-cognito/5.8.1-create-user-pool/><b>5.8.1. </b>Tạo Cognito User Pool
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.8-cognito/5.8.2-password-policies/ title="Cấu hình Password Policies" class=dd-item><a href=../../../vi/5-workshop/5.8-cognito/5.8.2-password-policies/><b>5.8.2. </b>Cấu hình Password Policies
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.8-cognito/5.8.3-email-verification/ title="Thiết lập Email Verification" class=dd-item><a href=../../../vi/5-workshop/5.8-cognito/5.8.3-email-verification/><b>5.8.3. </b>Thiết lập Email Verification
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.8-cognito/5.8.4-app-client/ title="Cấu hình App Client" class=dd-item><a href=../../../vi/5-workshop/5.8-cognito/5.8.4-app-client/><b>5.8.4. </b>Cấu hình App Client
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.9-keymanagementservice/ title="Thiếp lập KMS" class=dd-item><a href=../../../vi/5-workshop/5.9-keymanagementservice/><b>5.9. </b>Thiếp lập KMS
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.17-secretmanager/ title="Cấu hình AWS Secrets Manager" class=dd-item><a href=../../../vi/5-workshop/5.17-secretmanager/><b>5.17. </b>Cấu hình AWS Secrets Manager
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.18-waf/ title="Cấu hình Web ACL" class=dd-item><a href=../../../vi/5-workshop/5.18-waf/><b>5.18. </b>Cấu hình Web ACL
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/3-blogstranslated/ title="Các bài blogs đã dịch" class="dd-item
parent"><a href=../../../vi/3-blogstranslated/><b>3. </b>Các bài blogs đã dịch
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/3-blogstranslated/3.1-blog1/ title="Blog 1" class="dd-item
active"><a href=../../../vi/3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.2-blog2/ title="Blog 2" class=dd-item><a href=../../../vi/3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.3-blog3/ title="Blog 3" class=dd-item><a href=../../../vi/3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.4-blog4/ title="Blog 4" class=dd-item><a href=../../../vi/3-blogstranslated/3.4-blog4/><b>3.4. </b>Blog 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.5-blog5/ title="Blog 5" class=dd-item><a href=../../../vi/3-blogstranslated/3.5-blog5/><b>3.5. </b>Blog 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.6-blog6/ title="Blog 6" class=dd-item><a href=../../../vi/3-blogstranslated/3.6-blog6/><b>3.6. </b>Blog 6
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/6-self-evaluation/ title="Tự đánh giá" class=dd-item><a href=../../../vi/6-self-evaluation/><b>6. </b>Tự đánh giá
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/7-feedback/ title="Chia sẻ, đóng góp ý kiến" class=dd-item><a href=../../../vi/7-feedback/><b>7. </b>Chia sẻ, đóng góp ý kiến
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://thanhtu18.github.io/workshop-template/3-blogstranslated/3.1-blog1/>English</option><option id=vi value=https://thanhtu18.github.io/workshop-template/vi/3-blogstranslated/3.1-blog1/ selected>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../../vi/>Báo cáo thực tập</a> > <a href=../../../vi/3-blogstranslated/>Các bài blogs đã dịch</a> > Blog 1</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#tổng-quan-giải-pháp>Tổng quan giải pháp</a></li><li><a href=#yêu-cầu-chuẩn-bị>Yêu cầu chuẩn bị</a></li><li><a href=#thêm-emr-serverless-vào-compute>Thêm EMR Serverless vào compute</a></li><li><a href=#phát-triển-giám-sát-và-gỡ-lỗi-ứng-dụng-spark-trong-notebook-jupyter>Phát triển, giám sát và gỡ lỗi ứng dụng Spark trong notebook Jupyter</a><ul><li><a href=#các-bước-thực-hiện>Các bước thực hiện:</a></li></ul></li><li><a href=#giám-sát-công-việc-trong-spark-ui>Giám sát công việc trong Spark UI</a></li><li><a href=#dọn-dẹp>Dọn dẹp</a></li><li><a href=#kết-luận>Kết luận</a></li><li><a href=#phụ-lục>Phụ lục</a><ul><li><a href=#chạy-workload-theo-lịch>Chạy workload theo lịch</a></li></ul></li><li><a href=#blog1images3-blogbdb-5127-airflow-sparkui-17jpeg><img src=../../../images/3-Blog/BDB-5127-Airflow-SparkUI-17.jpeg alt=blog1></a></li><li><a href=#về-các-tác-giả>Về các tác giả</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 1</h1><h1 id=phát-triển-và-giám-sát-ứng-dụng-spark-sử-dụng-dữ-liệu-hiện-có-trong-amazon-s3-với-amazon-sagemaker-unified-studio>Phát triển và giám sát ứng dụng Spark sử dụng dữ liệu hiện có trong Amazon S3 với Amazon SageMaker Unified Studio</h1><p>Tác giả:Amit Maindola và Abhilash Nagilla | Ngày: 09 tháng 7 năm 2025 | Danh mục: <a href=https://aws.amazon.com/blogs/big-data/category/analytics/amazon-sagemaker-data-ai-governance/>Amazon SageMaker Data & AI Governance</a>, <a href=https://aws.amazon.com/blogs/big-data/category/analytics/amazon-sagemaker-lakehouse/>Amazon SageMaker Lakehouse</a>, <a href=https://aws.amazon.com/blogs/big-data/category/analytics/amazon-sagemaker-unified-studio/>Amazon SageMaker Unified Studio</a>, <a href=https://aws.amazon.com/blogs/big-data/category/analytics/>Analytics</a>, <a href=https://aws.amazon.com/blogs/big-data/category/post-types/technical-how-to/>Technical How-to</a></p><hr><p>Các tổ chức thường đối mặt với thách thức đáng kể trong quản lý khối lượng công việc phân tích dữ liệu lớn (big data analytics). Nhóm dữ liệu gặp khó khăn với môi trường phát triển phân mảnh, quản lý tài nguyên phức tạp, giám sát không nhất quán và quy trình lập lịch thủ công rườm rà. Những vấn đề này dẫn đến chu kỳ phát triển kéo dài, sử dụng tài nguyên không hiệu quả, khắc phục sự cố mang tính phản ứng và pipeline dữ liệu khó duy trì. Những thách thức này đặc biệt nghiêm trọng đối với các doanh nghiệp xử lý hàng terabyte dữ liệu hàng ngày cho business intelligence (BI), báo cáo và machine learning (ML). Những tổ chức như vậy cần các giải pháp thống nhất để hợp lý hóa toàn bộ quy trình phân tích.</p><p>Thế hệ tiếp theo của <a href=https://aws.amazon.com/sagemaker/>Amazon SageMaker</a> kết hợp với <a href=https://aws.amazon.com/emr/>Amazon EMR</a> trong <a href=https://aws.amazon.com/sagemaker/unified-studio/>Amazon SageMaker Unified Studio</a> giải quyết những điểm đau này thông qua một môi trường phát triển tích hợp (IDE) nơi các nhân viên làm việc dữ liệu có thể phát triển, thử nghiệm và tinh chỉnh ứng dụng Spark trong một môi trường nhất quán. <a href=https://aws.amazon.com/emr/serverless/>Amazon EMR Serverless</a> giảm bớt gánh nặng quản lý cụm bằng cách cấp phát tài nguyên động dựa vào yêu cầu khối lượng công việc, và các công cụ giám sát tích hợp giúp các nhóm nhanh chóng xác định điểm nghẽn hiệu năng.</p><p>Việc tích hợp với <a href=https://airflow.apache.org/>Apache Airflow</a> thông qua <a href=https://aws.amazon.com/managed-workflows-for-apache-airflow/>Amazon Managed Workflows for Apache Airflow</a> (Amazon MWAA) mang lại khả năng lập lịch mạnh mẽ, và mô hình trả phí cho tài nguyên sử dụng (&ldquo;pay-only-for-resources-used&rdquo;) đem lại tiết kiệm chi phí đáng kể.</p><p>Trong bài viết này, chúng tôi minh họa cách phát triển và giám sát một ứng dụng Spark sử dụng dữ liệu hiện có trong <a href=http://aws.amazon.com/s3>Amazon Simple Storage Service</a> (Amazon S3)** bằng SageMaker Unified Studio.</p><hr><h2 id=tổng-quan-giải-pháp>Tổng quan giải pháp</h2><p>Giải pháp này sử dụng SageMaker Unified Studio để thực thi và giám sát ứng dụng Spark, làm nổi bật các khả năng tích hợp. Chúng tôi trình bày các bước chính sau đây:</p><ol><li>Tạo môi trường compute EMR Serverless cho ứng dụng tương tác bằng SageMaker Unified Studio</li><li>Tạo và cấu hình ứng dụng Spark</li><li>Sử dụng dữ liệu <a href=https://www.tpc.org/tpcds/>TPC-DS</a> để xây dựng và chạy ứng dụng Spark bằng notebook <a href=https://jupyter.org/>Jupyter</a> trong SageMaker Unified Studio</li><li>Giám sát hiệu năng ứng dụng và lập lịch chạy định kỳ với tích hợp Amazon MWAA</li><li>Phân tích kết quả trong SageMaker Unified Studio để tối ưu hóa quy trình làm việc</li></ol><hr><h2 id=yêu-cầu-chuẩn-bị>Yêu cầu chuẩn bị</h2><p>Để theo dõi bài hướng dẫn này, bạn cần các yêu cầu sau:</p><ul><li><strong>Một tài khoản AWS</strong> – Nếu bạn chưa có tài khoản, bạn có thể <a href=https://aws.amazon.com/premiumsupport/knowledge-center/create-and-activate-aws-account/>create one</a></li><li><strong>Một domain SageMaker Unified Studio</strong> – Để biết hướng dẫn, xem <a href=https://docs.aws.amazon.com/sagemaker-unified-studio/latest/adminguide/create-domain-sagemaker-unified-studio-quick.html>Create an Amazon SageMaker Unified Studio domain – quick setup</a></li><li><strong>Một dự án demo</strong> – Tạo một dự án demo trong domain SageMaker Unified Studio của bạn. Để biết hướng dẫn, hãy xem <a href=https://docs.aws.amazon.com/sagemaker-unified-studio/latest/userguide/getting-started-create-a-project.html>Create a project</a>. Đối với ví dụ này, chúng tôi chọn profile có <strong>All capabilities</strong> trong phần cấu hình dự án</li></ul><hr><h2 id=thêm-emr-serverless-vào-compute>Thêm EMR Serverless vào compute</h2><p>Hoàn thành các bước sau để tạo môi trường compute EMR Serverless để xây dựng ứng dụng Spark:</p><ol><li>Trong SageMaker Unified Studio, mở dự án bạn đã tạo làm yêu cầu trước và chọn <strong>Compute</strong></li><li>Chọn <strong>Data processing</strong>, sau đó chọn <strong>Add compute</strong></li><li>Chọn <strong>Create new compute resources</strong>, rồi chọn <strong>Next</strong>
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-EMR-Add-Compute-1-New.png></li><li>Chọn <strong>EMR Serverless</strong>, rồi chọn <strong>Next</strong>
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-EMR-Serverless-2-New.png></li><li>Nhập tên cho <strong>Compute name</strong></li><li>Với <strong>Release label</strong>, chọn <strong>emr-7.5.0</strong></li><li>Với <strong>Permission mode</strong>, chọn <strong>Compatibility</strong></li><li>Chọn <strong>Add compute</strong></li></ol><p>Quá trình khởi tạo ứng dụng EMR Serverless mất vài phút. Sau khi tạo xong, bạn có thể xem compute trong SageMaker Unified Studio.
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-Compute-3-1.png></p><p>Các bước trên minh họa cách bạn thiết lập một ứng dụng Amazon EMR Serverless trong SageMaker Unified Studio để chạy các workloads PySpark tương tác. Trong các bước tiếp theo, chúng tôi sẽ xây dựng và theo dõi ứng dụng Spark trong không gian làm việc JupyterLab tương tác.</p><hr><h2 id=phát-triển-giám-sát-và-gỡ-lỗi-ứng-dụng-spark-trong-notebook-jupyter>Phát triển, giám sát và gỡ lỗi ứng dụng Spark trong notebook Jupyter</h2><p>Trong phần này, chúng tôi xây dựng ứng dụng Spark sử dụng dataset TPC-DS trong SageMaker Unified Studio. Với <a href=https://aws.amazon.com/sagemaker/data-processing/>Amazon SageMaker Data Processing</a>, bạn có thể tập trung vào chuyển đổi và phân tích dữ liệu mà không cần quản lý công suất compute hay ứng dụng nguồn mở, tiết kiệm thời gian và giảm chi phí.</p><p>SageMaker Data Processing cung cấp trải nghiệm phát triển thống nhất từ Amazon EMR, <a href=https://aws.amazon.com/glue>AWS Glue</a>, <a href=http://aws.amazon.com/redshift>Amazon Redshift</a>, <a href=http://aws.amazon.com/athena>Amazon Athena</a>, và Amazon MWAA trong cùng một notebook và giao diện truy vấn. Bạn có thể tự động cấp phát công suất trên <a href=http://aws.amazon.com/ec2>Amazon Elastic Compute Cloud</a> (Amazon EC2) hoặc EMR Serverless. Các quy tắc autoscaling quản lý thay đổi nhu cầu compute để tối ưu hiệu suất và thời gian thực thi.</p><h3 id=các-bước-thực-hiện>Các bước thực hiện:</h3><ol><li>Sau khi hoàn thành các bước chuẩn bị trước đó, vào SageMaker Studio và mở dự án của bạn</li><li>Chọn <strong>Build</strong>, sau đó chọn <strong>JupyterLab</strong>
Notebook mất khoảng 30 giây để khởi tạo và kết nối vào không gian làm việc</li><li>Dưới danh mục <strong>Notebook</strong>, chọn <strong>Python 3 (ipykernel)</strong></li><li>Trong cell đầu tiên, kế bên <strong>Local Python</strong>, chọn menu thả xuống và chọn <strong>PySpark</strong></li><li>Chọn menu thả xuống kế bên <strong>Project.Spark</strong> và chọn compute <strong>EMR-S Compute</strong>
6.Chạy mã sau để phát triển ứng dụng Spark của bạn. Ví dụ này đọc dataset TPC-DS 3 TB ở định dạng Parquet từ một bucket S3 công khai:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://blogpost-sparkoneks-us-east-1/blog/BLOG_TPCDS-TEST-3T-partitioned/store/&#34;</span>)<span style=color:#f92672>.</span>createOrReplaceTempView(<span style=color:#e6db74>&#34;store&#34;</span>)
</span></span></code></pre></div><p>Khi phiên Spark bắt đầu và logs thực thi bắt đầu xuất hiện, bạn có thể khám phá giao diện Spark UI và logs driver để gỡ lỗi và khắc phục chương trình Spark.
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-UI-Driver-4.png>
Ảnh chụp màn hình sau đây hiển thị ví dụ về giao diện người dùng Spark.
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-SparkUI-5.png>
Ảnh chụp màn hình sau đây hiển thị ví dụ về nhật ký trình điều khiển.
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-Spark-Driver-6.png>
Ảnh chụp màn hình sau đây hiển thị tab Executors, cung cấp quyền truy cập vào nhật ký trình điều khiển và trình thực thi.
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-Executors-7.png></p><ol start=7><li>Sử dụng mã sau để đọc thêm một số tập dữ liệu TPC-DS. Bạn có thể tạo chế độ xem tạm thời và sử dụng Spark UI để xem các tệp đang được đọc. Tham khảo phần phụ lục ở cuối bài viết này để biết chi tiết về cách sử dụng tập dữ liệu TPC-DS trong các bucket của bạn.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://blogpost-sparkoneks-us-east-1/blog/BLOG_TPCDS-TEST-3T-partitioned/item/&#34;</span>)<span style=color:#f92672>.</span>createOrReplaceTempView(<span style=color:#e6db74>&#34;item&#34;</span>)
</span></span><span style=display:flex><span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://blogpost-sparkoneks-us-east-1/blog/BLOG_TPCDS-TEST-3T-partitioned/store_sales/&#34;</span>)<span style=color:#f92672>.</span>createOrReplaceTempView(<span style=color:#e6db74>&#34;store_sales&#34;</span>)
</span></span><span style=display:flex><span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://blogpost-sparkoneks-us-east-1/blog/BLOG_TPCDS-TEST-3T-partitioned/date_dim/&#34;</span>)<span style=color:#f92672>.</span>createOrReplaceTempView(<span style=color:#e6db74>&#34;date_dim&#34;</span>)
</span></span><span style=display:flex><span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://blogpost-sparkoneks-us-east-1/blog/BLOG_TPCDS-TEST-3T-partitioned/customer/&#34;</span>)<span style=color:#f92672>.</span>createOrReplaceTempView(<span style=color:#e6db74>&#34;customer&#34;</span>)
</span></span><span style=display:flex><span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://blogpost-sparkoneks-us-east-1/blog/BLOG_TPCDS-TEST-3T-partitioned/catalog_sales/&#34;</span>)<span style=color:#f92672>.</span>createOrReplaceTempView(<span style=color:#e6db74>&#34;catalog_sales&#34;</span>)
</span></span><span style=display:flex><span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://blogpost-sparkoneks-us-east-1/blog/BLOG_TPCDS-TEST-3T-partitioned/web_sales/&#34;</span>)<span style=color:#f92672>.</span>createOrReplaceTempView(<span style=color:#e6db74>&#34;web_sales&#34;</span>)
</span></span></code></pre></div><p>Trong mỗi cell của notebook, bạn có thể mở Spark Job Progress để xem các giai đoạn của job gửi đến EMR Serverless cho một cell cụ thể. Bạn có thể xem thời gian hoàn thành mỗi giai đoạn. Nếu xảy ra lỗi, bạn có thể kiểm tra logs, giúp việc khắc phục sự cố liền mạch hơn.
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-Spark-Job-Progress-8.png>
Vì các file được phân vùng dựa trên cột khóa ngày, bạn có thể quan sát rằng Spark chạy các tác vụ song song để đọc dữ liệu.
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-SparkJobs-9.png>
8. Tiếp theo, lấy count theo các khóa ngày trên dữ liệu được phân vùng theo khóa thời gian bằng mã:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>select count(<span style=color:#ae81ff>1</span>), ss_sold_date_sk <span style=color:#f92672>from</span> store_sales group by ss_sold_date_sk order by ss_sold_date_sk
</span></span></code></pre></div><p><img alt=blog1 src=../../../images/3-Blog/BDB-5127-Notebook-Block-10.png></p><h2 id=giám-sát-công-việc-trong-spark-ui>Giám sát công việc trong Spark UI</h2><p>Trong tab <strong>Jobs</strong> của Spark UI, bạn có thể xem danh sách các job hoàn thành hoặc đang chạy, với các thông tin sau:</p><ul><li>Hành động kích hoạt job</li><li>Thời gian thực hiện (ví dụ: 41 giây, nhưng thời gian sẽ khác nhau)</li><li>Số giai đoạn (stages) và tác vụ (tasks) — trong ví dụ này là 2 stages và 3.428 tasks</li></ul><p>Bạn có thể chọn job để xem chi tiết hơn, đặc biệt về các giai đoạn. Job của chúng tôi có hai giai đoạn; một stage mới được tạo mỗi khi có shuffle. Chúng tôi có một stage để đọc dữ liệu mỗi dataset ban đầu, và một stage cho phép tổng hợp (aggregation).
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-JobRun-11.gif>
Trong ví dụ tiếp theo, chúng tôi chạy một số câu SQL TPC-DS dùng để đánh giá hiệu năng và benchmark:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>with</span> frequent_ss_items <span style=color:#66d9ef>as</span>
</span></span><span style=display:flex><span> (<span style=color:#66d9ef>select</span> substr(i_item_desc,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>30</span>) itemdesc,i_item_sk item_sk,d_date solddate,<span style=color:#66d9ef>count</span>(<span style=color:#f92672>*</span>) cnt
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>from</span> store_sales, date_dim, item
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>where</span> ss_sold_date_sk <span style=color:#f92672>=</span> d_date_sk
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>and</span> ss_item_sk <span style=color:#f92672>=</span> i_item_sk
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>and</span> d_year <span style=color:#66d9ef>in</span> (<span style=color:#ae81ff>2000</span>, <span style=color:#ae81ff>2000</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2000</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>2000</span><span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> substr(i_item_desc,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>30</span>),i_item_sk,d_date
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>having</span> <span style=color:#66d9ef>count</span>(<span style=color:#f92672>*</span>) <span style=color:#f92672>&gt;</span><span style=color:#ae81ff>4</span>),
</span></span><span style=display:flex><span> max_store_sales <span style=color:#66d9ef>as</span>
</span></span><span style=display:flex><span> (<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>max</span>(csales) tpcds_cmax
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>from</span> (<span style=color:#66d9ef>select</span> c_customer_sk,<span style=color:#66d9ef>sum</span>(ss_quantity<span style=color:#f92672>*</span>ss_sales_price) csales
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>from</span> store_sales, customer, date_dim
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>where</span> ss_customer_sk <span style=color:#f92672>=</span> c_customer_sk
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>and</span> ss_sold_date_sk <span style=color:#f92672>=</span> d_date_sk
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>and</span> d_year <span style=color:#66d9ef>in</span> (<span style=color:#ae81ff>2000</span>, <span style=color:#ae81ff>2000</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2000</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>2000</span><span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> c_customer_sk) x),
</span></span><span style=display:flex><span> best_ss_customer <span style=color:#66d9ef>as</span>
</span></span><span style=display:flex><span> (<span style=color:#66d9ef>select</span> c_customer_sk,<span style=color:#66d9ef>sum</span>(ss_quantity<span style=color:#f92672>*</span>ss_sales_price) ssales
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>from</span> store_sales, customer
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>where</span> ss_customer_sk <span style=color:#f92672>=</span> c_customer_sk
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> c_customer_sk
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>having</span> <span style=color:#66d9ef>sum</span>(ss_quantity<span style=color:#f92672>*</span>ss_sales_price) <span style=color:#f92672>&gt;</span> (<span style=color:#ae81ff>95</span><span style=color:#f92672>/</span><span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span>) <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> max_store_sales))
</span></span><span style=display:flex><span> <span style=color:#66d9ef>select</span> <span style=color:#66d9ef>sum</span>(sales)
</span></span><span style=display:flex><span> <span style=color:#66d9ef>from</span> (<span style=color:#66d9ef>select</span> cs_quantity<span style=color:#f92672>*</span>cs_list_price sales
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>from</span> catalog_sales, date_dim
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>where</span> d_year <span style=color:#f92672>=</span> <span style=color:#ae81ff>2000</span>
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>and</span> d_moy <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>and</span> cs_sold_date_sk <span style=color:#f92672>=</span> d_date_sk
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>and</span> cs_item_sk <span style=color:#66d9ef>in</span> (<span style=color:#66d9ef>select</span> item_sk <span style=color:#66d9ef>from</span> frequent_ss_items)
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>and</span> cs_bill_customer_sk <span style=color:#66d9ef>in</span> (<span style=color:#66d9ef>select</span> c_customer_sk <span style=color:#66d9ef>from</span> best_ss_customer)
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>union</span> <span style=color:#66d9ef>all</span>
</span></span><span style=display:flex><span>      (<span style=color:#66d9ef>select</span> ws_quantity<span style=color:#f92672>*</span>ws_list_price sales
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>from</span> web_sales, date_dim
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>where</span> d_year <span style=color:#f92672>=</span> <span style=color:#ae81ff>2000</span>
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>and</span> d_moy <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>and</span> ws_sold_date_sk <span style=color:#f92672>=</span> d_date_sk
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>and</span> ws_item_sk <span style=color:#66d9ef>in</span> (<span style=color:#66d9ef>select</span> item_sk <span style=color:#66d9ef>from</span> frequent_ss_items)
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>and</span> ws_bill_customer_sk <span style=color:#66d9ef>in</span> (<span style=color:#66d9ef>select</span> c_customer_sk <span style=color:#66d9ef>from</span> best_ss_customer))) x
</span></span></code></pre></div><p>Bạn có thể giám sát công việc Spark trong SageMaker Unified Studio bằng hai cách. Notebook Jupyter cung cấp giám sát cơ bản, hiển thị trạng thái job real-time và tiến độ thực thi. Để có phân tích chi tiết hơn, sử dụng Spark UI. Bạn có thể kiểm tra các giai đoạn cụ thể, tasks, và kế hoạch thực thi. Spark UI đặc biệt hữu ích để khắc phục vấn đề hiệu năng và tối ưu truy vấn. Bạn có thể theo dõi số lượng giai đoạn dự kiến, tasks chạy, và chi tiết thời lượng mỗi task.Cái nhìn toàn diện này giúp bạn hiểu sử dụng tài nguyên và theo dõi tiến độ job ở mức chi tiết.</p><p><img alt=blog1 src=../../../images/3-Blog/BDB-5127-Spark-TPCDS-12.gif>
Trong phần này, chúng tôi đã giải thích cách bạn có thể dùng compute EMR Serverless trong SageMaker Unified Studio để xây dựng ứng dụng Spark tương tác. Qua Spark UI, ứng dụng tương tác cung cấp trạng thái mức tác vụ chi tiết, thông tin I/O và shuffle, cũng như liên kết đến logs tương ứng của tasks trực tiếp từ notebook, giúp trải nghiệm gỡ lỗi liền mạch.</p><hr><h2 id=dọn-dẹp>Dọn dẹp</h2><p>Để tránh phát sinh chi phí liên tục trong tài khoản AWS của bạn, hãy xóa các tài nguyên bạn đã tạo trong bài hướng dẫn:</p><ol><li>Xóa connection</li><li>Xóa job EMR</li><li>Xóa các S3 buckets đầu ra của EMR</li><li>Xóa các tài nguyên Amazon MWAA như workflows và environments</li></ol><hr><h2 id=kết-luận>Kết luận</h2><p>Trong bài viết này, chúng tôi đã minh họa cách thế hệ tiếp theo của SageMaker, kết hợp với EMR Serverless, cung cấp giải pháp mạnh mẽ để phát triển, giám sát và lập lịch các ứng dụng Spark sử dụng dữ liệu trong Amazon S3. Trải nghiệm tích hợp giúp giảm đáng kể sự phức tạp bằng cách cung cấp môi trường phát triển thống nhất, quản lý tài nguyên tự động, và khả năng giám sát toàn diện thông qua Spark UI, trong khi vẫn duy trì hiệu quả chi phí theo mô hình trả theo sử dụng. Đối với doanh nghiệp, điều này có nghĩa là thời gian để có insight nhanh hơn, cải thiện sự hợp tác nhóm, và giảm gánh nặng vận hành, để các nhóm dữ liệu có thể tập trung vào phân tích thay vì quản lý hạ tầng.</p><p>Để bắt đầu, hãy khám phá <a href=https://docs.aws.amazon.com/sagemaker-unified-studio/latest/userguide/what-is-sagemaker-unified-studio.html>Amazon SageMaker Unified Studio User Guide</a>, thiết lập một dự án trong môi trường AWS của bạn, và khám phá cách giải pháp này có thể biến đổi khả năng phân tích dữ liệu của tổ chức bạn.</p><hr><h2 id=phụ-lục>Phụ lục</h2><p>Trong các phần sau, chúng tôi thảo luận cách chạy workload theo lịch và cung cấp chi tiết về dataset TPC-DS để xây dựng ứng dụng Spark sử dụng EMR Serverless.</p><h3 id=chạy-workload-theo-lịch>Chạy workload theo lịch</h3><p>Trong phần này, chúng tôi triển khai notebook JupyterLab và tạo workflow sử dụng Amazon MWAA. Bạn có thể dùng workflows để điều phối notebooks, querybooks và nhiều thứ khác trong kho dự án của bạn. Với workflows, bạn có thể định nghĩa một tập các tác vụ tổ chức dưới dạng directed acyclic graph (DAG) có thể chạy theo lịch mà bạn định nghĩa.Các bước thực hiện:</p><ol><li>Trong SageMaker Unified Studio, chọn <strong>Build</strong>, và dưới <strong>Orchestration</strong>, chọn <strong>Workflows</strong>
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-Workflow-13.png></li><li>Chọn <strong>Create Workflow in Editor</strong>
Bạn sẽ được chuyển đến notebook JupyterLab với DAG mới tên <code>untitled.py</code> được tạo trong thư mục <code>/src/workflows/dag</code></li><li>Đổi tên notebook này thành <code>tpcds_data_queries.py</code></li></ol><p>4.Bạn có thể tái sử dụng template hiện có với các cập nhật sau:</p><p>a. Cập nhật dòng 17 với lịch bạn muốn mã của bạn chạy
b. CCập nhật dòng 26 với NOTEBOOK_PATH của bạn. Đường dẫn này nên nằm trong src/&lt;notebook_name>.ipynb. Lưu ý tên dag_id được tạo tự động; bạn có thể đặt tên theo yêu cầu của bạn.
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-Spark-TPCDS-DagNotebk-14.jpg>
5. Chọn <strong>File</strong> và <strong>Save notebook</strong>
Để kiểm thử, bạn có thể kích hoạt chạy thủ công workload
6. Trong SageMaker Unified Studio, chọn <strong>Build</strong>, rồi dưới <strong>Orchestration</strong>, chọn <strong>Workflows</strong>.
7. Chọn workflow của bạn, rồi chọn <strong>Run</strong>.
Bạn có thể giám sát thành công của job trên tab Runs.
<img alt=blog1 src=../../../images/3-Blog/BDB-5127-AirflowRun-15.png>
Để gỡ lỗi job notebook bằng cách truy cập Spark UI trong console Airflow job, bạn phải sử dụng <a href=https://docs.aws.amazon.com/emr/latest/EMR-Serverless-UserGuide/using-airflow.html>EMR Serverless Airflow Operators</a> để gửi job. Liên kết có sẵn trên tab <strong>Details</strong> của truy vấn.
Tùy chọn này có các hạn chế chính: nó không khả dụng cho Amazon EMR trên EC2, và các operator notebook job SageMaker không hoạt động.</p><p>Bạn có thể cấu hình operator để tạo liên kết một lần đến UI ứng dụng và logs đầu ra Spark bằng cách truyền <code>enable_application_ui_links=True</code> làm tham số. Sau khi job bắt đầu chạy, các liên kết này có sẵn trên tab Details của task tương ứng. Nếu <code>enable_application_ui_links=False</code>, thì liên kết sẽ xuất hiện nhưng ở trạng thái xám.</p><p>Hãy đảm bảo bạn có <code>emr-serverless:GetDashboardForJobRun </code>trong <a href=https://aws.amazon.com/iam/>AWS Identity and Access Management</a>(IAM) để tạo liên kết dashboard.</p><p>Mở giao diện người dùng Airflow cho tác vụ của bạn. Giao diện người dùng Spark và các tùy chọn bảng điều khiển máy chủ lịch sử sẽ hiển thị trên tab Details, như trong ảnh chụp màn hình sau.</p><p><img alt=blog1 src=../../../images/3-Blog/BDB-5127-AirflowUI-16.jpeg></p><p>Ảnh chụp màn hình minh họa tab Jobs của Spark UI được trình bày.</p><h2 id=blog1images3-blogbdb-5127-airflow-sparkui-17jpeg><img alt=blog1 src=../../../images/3-Blog/BDB-5127-Airflow-SparkUI-17.jpeg></h2><h2 id=về-các-tác-giả>Về các tác giả</h2><div style=display:flex;align-items:flex-start;margin-bottom:30px><img src=../../../images/3-Blog/Amit-Maindola.jpg alt="Amit Maindola" style=width:150px;height:150px;object-fit:cover;margin-right:20px;border-radius:8px><div><p><strong>Amit Maindola</strong> là Senior Data Architect tập trung vào data engineering, analytics và AI/ML tại Amazon Web Services. Ông giúp khách hàng trong quá trình chuyển đổi số và cho phép họ xây dựng các giải pháp phân tích đám mây quy mô cao, mạnh mẽ và an toàn trên AWS để thu được insight kịp thời và ra quyết định kinh doanh quan trọng.</p></div></div><div style=display:flex;align-items:flex-start;margin-bottom:30px><img src=../../../images/3-Blog/image045.jpg alt="Abhilash Nagilla" style=width:150px;height:150px;object-fit:cover;margin-right:20px;border-radius:8px><div><p><strong>Abhilash Nagilla</strong> là senior specialist solutions architect tại Amazon Web Services (AWS), hỗ trợ các khách hàng khu vực công trên hành trình đám mây của họ với trọng tâm là các dịch vụ dữ liệu và AI của AWS. Ngoài công việc, Abhilash thích tìm hiểu công nghệ mới, xem phim và đi du lịch đến những nơi mới.</p></div></div><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../../vi/3-blogstranslated/ title="Các bài blogs đã dịch"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../../vi/3-blogstranslated/3.2-blog2/ title="Blog 2" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../../js/clipboard.min.js?1765294078></script><script src=../../../js/perfect-scrollbar.min.js?1765294078></script><script src=../../../js/perfect-scrollbar.jquery.min.js?1765294078></script><script src=../../../js/jquery.sticky.js?1765294078></script><script src=../../../js/featherlight.min.js?1765294078></script><script src=../../../js/highlight.pack.js?1765294078></script><script>hljs.initHighlightingOnLoad()</script><script src=../../../js/modernizr.custom-3.6.0.js?1765294078></script><script src=../../../js/learn.js?1765294078></script><script src=../../../js/hugo-learn.js?1765294078></script><link href=../../../mermaid/mermaid.css?1765294078 rel=stylesheet><script src=../../../mermaid/mermaid.js?1765294078></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>